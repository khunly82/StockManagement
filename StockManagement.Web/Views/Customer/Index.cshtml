@model CustomerIndexViewModel

@{
    ViewBag.Title = "Index";
}
<p>
    @if(User.IsInRole("Admin"))
    {
        <a class="btn btn-primary" asp-action="Create">Nouveau</a>
    }
</p>

<form method="get" class="mb-3">
    <div class="row">
        <div class="form-group col-md-4">
            @Html.EditorFor(m => m.Search, new { htmlAttributes = new { @class = "form-control", autofocus = true, placeholder = "ref, nom" } })
            @Html.ValidationMessageFor(m => m.Search, "", new { @class = "text-danger" })
        </div>
        <div class="form-group col-md-12 mt-3">
            <button class="btn btn-info"><i class="fa fa-search"></i></button>
        </div>
    </div>
</form>

@if (Model.Results.Count() > 0)
{
    @await Html.PartialAsync("Partials/_Table", Model.Results)
    @await Html.PartialAsync("Partials/_Pagination", Model)
}
else
{
    <p>Aucun résultat</p>
}

@section scripts {
    <script>
        const deleteBtns = document.querySelectorAll('.delete-btn');
        for (let btn of deleteBtns) {
            btn.addEventListener('click', e => {
                e.preventDefault();
                confirmBox.show({
                    title: 'Demande de confirmation.',
                    content: `Êtes vous sûr de vouloir supprimer ce client?`,
                    onConfirm: () => {
                        // besoin de supprimer l'event des icons pour être sûr 
                        // que e.target soit bien le lien "<a>"
                        // voir css 
                        // ex: delete-btn > i { pointer-event: none }
                        window.location.href = e.target.getAttribute('href');
                    }
                });
            });
        }
    </script>
}